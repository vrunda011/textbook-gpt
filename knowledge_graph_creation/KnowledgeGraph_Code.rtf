{\rtf1\ansi\ansicpg1252\cocoartf2761
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 ArialMT;\f1\froman\fcharset0 Times-Bold;\f2\froman\fcharset0 Times-Roman;
}
{\colortbl;\red255\green255\blue255;\red0\green0\blue109;\red0\green0\blue0;\red253\green134\blue8;
}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c50196;\cssrgb\c0\c0\c0;\cssrgb\c100000\c60000\c0;
}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid1\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat2\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid101\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat3\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid201\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat4\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid301\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat5\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid401\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat6\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid501\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat7\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid601\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat8\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid701\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat9\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid801\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat10\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid901\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid10}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\sa160\partightenfactor0

\f0\fs53\fsmilli26667 \cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Knowledge Graph code:
\f1\b\fs48 \cf0 \strokec3 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls1\ilvl0
\f0\b0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 \'a0CALL apoc.periodic.iterate(
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0'CALL apoc.load.json("file:///data.json") YIELD value AS data RETURN data',
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0'UNWIND keys(data) AS fileName
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0UNWIND keys(data[fileName]) AS pageNumberStr
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0WITH fileName, \cf4 \strokec4 toInteger(pageNumberStr) AS pageNumber\cf0 \strokec3 ,\'a0 data[fileName][pageNumberStr] AS pageData
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0MERGE (c:Chapter \{fileName: fileName, pageNumber: pageNumber\})
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0WITH c, pageData
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0UNWIND pageData.text_lines AS textLine
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0MERGE (t:TextLine \{
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0\'a0\'a0\'a0text: textLine.text,
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0\'a0\'a0\'a0confidence: textLine.confidence,
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0\'a0\'a0\'a0bbox: textLine.bbox
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\})
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0MERGE (c)-[:CONTAINS]->(t)',
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\{batchSize:1000, iterateList:true, parallel:true\}
\f2\fs24 \

\f0\fs29\fsmilli14667 );
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls2\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\fi960\partightenfactor0
\cf0 MATCH (c:Chapter)
\f2\fs24 \
\pard\pardeftab720\li960\fi-960\partightenfactor0

\f0\fs29\fsmilli14667 \cf0 RETURN c.fileName, c.pageNumber
\f2\fs24 \

\f0\fs29\fsmilli14667 ORDER BY c.fileName, c.pageNumber;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls3\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Create indexes for efficient querying
\f2\fs24 \

\f0\fs29\fsmilli14667 CREATE INDEX FOR (c:Chapter) ON (c.fileName);
\f2\fs24 \

\f0\fs29\fsmilli14667 CREATE INDEX FOR (c:Chapter) ON (c.pageNumber);
\f2\fs24 \

\f0\fs29\fsmilli14667 CREATE INDEX FOR (t:TextLine) ON (t.text);
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls4\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Count total number of Chapter nodes\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter)
\f2\fs24 \

\f0\fs29\fsmilli14667 RETURN count(c) AS totalChapters;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\pardeftab720\li960\fi-960\partightenfactor0

\f0\fs29\fsmilli14667 \cf0 // Count total number of TextLine nodes\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (t:TextLine)\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 RETURN count(t) AS totalTextLines;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls5\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Retrieve sample text lines from a specific chapter\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter \{fileName: 'fesc101.pdf', pageNumber: 0\})-[:CONTAINS]->(t:TextLine)\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 RETURN c.pageNumber, t.text\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 LIMIT 10;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls6\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Retrieve all chapters and their text line counts\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter)-[:CONTAINS]->(t:TextLine)
\f2\fs24 \

\f0\fs29\fsmilli14667 RETURN c.fileName, c.pageNumber, count(t) AS textLineCount\'a0
\f2\fs24 \

\f0\fs29\fsmilli14667 ORDER BY c.fileName, c.pageNumber;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls7\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	7	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \'a0\'a0\
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Create NEXT relationships between text lines based on their bounding boxes
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter)-[:CONTAINS]->(t1:TextLine), (c)-[:CONTAINS]->(t2:TextLine)
\f2\fs24 \

\f0\fs29\fsmilli14667 WHERE t1.bbox[1] < t2.bbox[1] AND NOT (t1)-[:NEXT]->(:TextLine)
\f2\fs24 \

\f0\fs29\fsmilli14667 MERGE (t1)-[:NEXT]->(t2);
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls8\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	8	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \'a0\
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 Assign chapter names based on fileName:
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter)
\f2\fs24 \

\f0\fs29\fsmilli14667 SET c.chapterName = CASE
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc101.pdf' THEN 'Chapter 1'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc102.pdf' THEN 'Chapter 2'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc103.pdf' THEN 'Chapter 3'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc104.pdf' THEN 'Chapter 4'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc105.pdf' THEN 'Chapter 5'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc106.pdf' THEN 'Chapter 6'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc107.pdf' THEN 'Chapter 7'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc108.pdf' THEN 'Chapter 8'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc109.pdf' THEN 'Chapter 9'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc110.pdf' THEN 'Chapter 10'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0WHEN c.fileName = 'fesc111.pdf' THEN 'Chapter 11'
\f2\fs24 \

\f0\fs29\fsmilli14667 \'a0\'a0\'a0\'a0ELSE 'Unknown Chapter'
\f2\fs24 \

\f0\fs29\fsmilli14667 END;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls9\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	9	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Retrieve text lines for a specific chapter name
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter \{chapterName: 'Chapter 1'\})-[:CONTAINS]->(t:TextLine)
\f2\fs24 \

\f0\fs29\fsmilli14667 RETURN t.text;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls10\ilvl0
\f0\fs29\fsmilli14667 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	10	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 \
\pard\pardeftab720\li960\fi-960\partightenfactor0
\cf0 // Retrieve all chapters with their page numbers and names
\f2\fs24 \

\f0\fs29\fsmilli14667 MATCH (c:Chapter)
\f2\fs24 \

\f0\fs29\fsmilli14667 RETURN c.fileName, c.pageNumber, c.chapterName
\f2\fs24 \

\f0\fs29\fsmilli14667 ORDER BY c.fileName, c.pageNumber;
\f2\fs24 \
\pard\pardeftab720\partightenfactor0
\cf0 \
\
\
}